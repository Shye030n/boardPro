<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!--MyBatis에서 사용하는 xmlMapper file - java코드와 DB간의 Mapping을 설정-->
<mapper namespace="orgsh.boardpro.mapper.BoardMapper">
    <!--  Mapper file의 경로  -->

    <sql id="search">
        <where>
            <if test="types != null and types.length > 0">
                <foreach collection="types" item="type" open="(" close=") " separator=" OR ">
                    <if test="type == 't'.toString()">
                        title like concat('%', #{keyword}, '%')
                    </if>

                    <if test="type == 'w'.toString()">
                        writer like concat('%', #{keyword}, '%')
                    </if>

                    <if test="type == 'c'.toString()">
                        content like concat('%', #{keyword}, '%')
                    </if>
                </foreach>
            </if>
        </where>
    </sql>

    <select id="getTime" resultType="String">
        <!-- id="getTime" 인터페이스에서 호출할 수 있는 메서드명, java코드에서 getTIme()하면 이 query문 실행 -->
        <!--interface 구체적인 구현을 하지않고, 메서드의 이름, 반환타입, 매개변수 등을 정의. 구체적인 구현은 클래스에서!-->
        select now()
    </select>

    <select id="selectList" resultType="orgsh.boardpro.vo.BoardVO">
        select * from tbl_board
        <include refid="search"></include>
        order by bno desc limit ${skip}, #{size}
    </select>

    <select id="getCount">
        select count(bno) from tbl_board
        <include refid="search"></include>
    </select>


    <insert id="insert">
<!--  insert(삽입작업)메서드의 이름을 insert라 정함.-->
        insert into tbl_board(title,content,postDate,writer) values(#{title},#{content},#{postDate},#{writer})
    </insert>
    <select id="selectOne" resultType="orgsh.boardpro.vo.BoardVO">
        select * from tbl_board where bno=#{bno}
    </select>
    <select id="getList" resultType="orgsh.boardpro.vo.BoardVO">
        select * from tbl_board
    </select>
    <delete id="delete">
        delete from tbl_board where bno=#{bno}
    </delete>
    <update id="update">
        update tbl_board set title=#{title}, content=#{content}, postDate=#{postDate} where bno=#{bno}
    </update>
    <!-- xml 쿼리를 직접 작성하는 곳-->
</mapper>